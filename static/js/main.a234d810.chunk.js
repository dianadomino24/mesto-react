(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{10:function(e,t,a){e.exports=a(16)},15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(7),c=a.n(r),i=(a(15),a(9)),l=a(1),s=a(4),u=a(5),p=new(function(){function e(t){var a=t.baseUrl,n=t.headers;Object(s.a)(this,e),this.baseUrl=a,this.headers=n}return Object(u.a)(e,[{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject(new Error("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status)))}},{key:"getItems",value:function(e){var t=this;return fetch(this.baseUrl.concat(e),{headers:this.headers}).then((function(e){return t._getResponseData(e)}))}},{key:"createItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(t),{method:"POST",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return a._getResponseData(e)}))}},{key:"changeItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(t),{method:"PATCH",headers:this.headers,body:JSON.stringify(e)}).then((function(e){return a._getResponseData(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.replaceItem("cards/likes",e):this.deleteItem("cards/likes",e)}},{key:"replaceItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(e).concat("/".concat(t)),{method:"PUT",headers:this.headers}).then((function(e){return a._getResponseData(e)}))}},{key:"deleteItem",value:function(e,t){var a=this;return fetch(this.baseUrl.concat(e).concat("/".concat(t)),{method:"DELETE",headers:this.headers}).then((function(e){return a._getResponseData(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/".concat("cohort-14","/"),headers:{authorization:"3829caf2-6683-412f-9e00-d0870fcd1817","Content-Type":"application/json"}}),m=a(8),_=a.n(m);var d=function(){return o.a.createElement("header",{className:"header page__header section"},o.a.createElement("a",{href:"/",className:"logo header__logo"},o.a.createElement("img",{className:"logo__image",src:_.a,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 Mesto"})))},f=o.a.createContext();function h(e){var t=e.onCardClick,a=e.card,n=e.onCardLike,r=e.onCardDelete,c=e.owner,i=e.likes,l=e.name,s=e.link;var u=o.a.useContext(f),p=c._id===u._id,m=i.some((function(e){return e._id===u._id}))?"place__like-button place__like-button_active":"place__like-button";return o.a.createElement("li",{className:"places__item"},o.a.createElement("figure",{className:"place"},o.a.createElement("button",{className:p?"link place__delete-button":"link place__delete-button place__delete-button_disabled",onClick:function(e){var t=e.target.closest(".places__item");r(a,t)}}),o.a.createElement("img",{src:s,alt:l,className:"place__image",onClick:function(){t(a)}}),o.a.createElement("div",{className:"place__wrapper"},o.a.createElement("h2",{className:"place__name"},l," "),o.a.createElement("button",{className:"place__like-button-container"},o.a.createElement("div",{className:m,onClick:function(){n(a)}}),o.a.createElement("div",{className:"place__like-counter"},i.length)))))}var v=function(e){var t=e.onEditProfile,a=e.onAddPlace,n=e.onEditAvatar,r=e.handleCardClick,c=e.cards,i=e.onCardLike,l=e.onCardDelete,s=o.a.useContext(f);return o.a.createElement("main",{className:"content page__content section"},o.a.createElement("section",{className:"profile section"},o.a.createElement("div",{className:"profile__image",onClick:n,style:{backgroundImage:"url(".concat(s.avatar,")")}}),o.a.createElement("div",{className:"profile__info"},o.a.createElement("div",{className:"profile__name-wrap"},o.a.createElement("h1",{className:"profile__name"},s.name),o.a.createElement("button",{className:"link profile__edit-button",onClick:t})),o.a.createElement("p",{className:"profile__job"},s.about)),o.a.createElement("button",{className:"link profile__add-button",onClick:a})),o.a.createElement("section",{className:"places section"},o.a.createElement("ul",{className:"places__list"},o.a.createElement("li",{className:"places__empty-list"},"\u041d\u0435\u0442 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u043d\u044b\u0445 \u043c\u0435\u0441\u0442"),c.map((function(e){return o.a.createElement(h,Object.assign({key:e._id,onCardClick:r,card:e,onCardLike:i,onCardDelete:l},e))})))))};var b=function(){return o.a.createElement("footer",{className:"footer section page__footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))},E={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_disabled",inputErrorClass:".popup__input-error",errorActiveClass:"popup__input-error_active",controlSelector:".popup__label"};var g=function(){function e(t,a){Object(s.a)(this,e),this._formSelectorsObj=t,this._formElement=a,this._inputList=Array.from(a.querySelectorAll(t.inputSelector)),this._buttonElement=a.querySelector(t.submitButtonSelector),this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorActiveClass=t.errorActiveClass,this._controlSelector=t.controlSelector}return Object(u.a)(e,[{key:"_findInputError",value:function(e){return e.closest(this._controlSelector).querySelector(this._inputErrorClass)}},{key:"_showInputError",value:function(e,t){var a=this._findInputError(e);a.textContent=t,a.classList.add(this._errorActiveClass)}},{key:"_hideInputError",value:function(e){var t=this._findInputError(e);t.classList.remove(this._errorActiveClass),t.textContent=""}},{key:"_isInputWithoutSpacingInvalid",value:function(e){var t=e.value.trim();return 0===t.length?1:t.length<2?2:0}},{key:"_checkInputValidity",value:function(e){var t=this._findInputError(e);switch(this._isInputWithoutSpacingInvalid(e)){case 1:t.textContent="\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u044d\u0442\u043e \u043f\u043e\u043b\u0435.",t.classList.add(this._errorActiveClass);break;case 2:t.textContent="\u0422\u0435\u043a\u0441\u0442 \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043d\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 2 \u0441\u0438\u043c\u0432. \u0414\u043b\u0438\u043d\u0430 \u0442\u0435\u043a\u0441\u0442\u0430 \u0441\u0435\u0439\u0447\u0430\u0441: 1 \u0441\u0438\u043c\u0432\u043e\u043b.",t.classList.add(this._errorActiveClass);break;case 0:e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage);break;default:alert("error")}}},{key:"hasInvalidInput",value:function(){var e=this;return this._inputList.some((function(t){return!t.validity.valid||e._isInputWithoutSpacingInvalid(t)}))}},{key:"_toggleButtonState",value:function(){this.hasInvalidInput()?this._buttonElement.classList.add(this._inactiveButtonClass):this._buttonElement.classList.remove(this._inactiveButtonClass)}},{key:"_setEventListeners",value:function(){var e=this;this._toggleButtonState(),this._inputList.forEach((function(t){t.addEventListener("input",(function(){e._checkInputValidity(t),e._toggleButtonState()}))}))}},{key:"enableValidation",value:function(){this._setEventListeners()}}]),e}();var k=function(e){var t=e.title,a=e.name,n=e.buttonText,r=e.isOpen,c=e.onClose,i=e.onSubmit,l=e.children;function s(){if(r){var e=document.querySelector(".popup__form_type_".concat(a)),t=new g(E,e);return t.enableValidation(),!t.hasInvalidInput()}}function u(){document.querySelector(".popup__form_type_".concat(a)).reset(),c(),window.removeEventListener("keydown",p)}function p(e){"Escape"===e.key&&u()}return s(),r&&window.addEventListener("keydown",(function(e){return p(e)})),o.a.createElement("section",{className:"popup popup_type_".concat(a," ").concat(r&&"popup_opened"),onClick:function(e){e.target===e.currentTarget&&u()}},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{className:"link popup__close-button",onClick:u}),o.a.createElement("form",{className:"popup__form popup__form_type_".concat(a),noValidate:!0,name:a,onSubmit:function(e){e.preventDefault(),s()&&(i(e),document.querySelector(".popup__form_type_".concat(a)).reset())}},o.a.createElement("h2",{className:"popup__title"},t),o.a.createElement("fieldset",{className:"popup__fieldset"},l,o.a.createElement("button",{className:"link popup__save-button popup__save-button_type_".concat(a),autoFocus:!0,type:"submit"},n)))))};var y=function(e){var t=e.title,a=e.name,n=e.card,r=e.cardDOM,c=e.buttonText,i=e.isOpen,l=e.onClose,s=e.onCardDeleteSubmit;return o.a.createElement(k,{title:t,name:a,buttonText:c,isOpen:i,onClose:l,onSubmit:function(e){e.preventDefault(),s(n,r)}})};var C=function(e){var t=e.card,a=e.onClose,n=e.isOpen,r=e.name;function c(){a(),window.removeEventListener("keydown",i)}function i(e){"Escape"===e.key&&c()}return t?(window.addEventListener("keydown",i),o.a.createElement("section",{className:"popup popup_type_".concat(r," ").concat(n&&"popup_opened"),onClick:function(e){e.target===e.currentTarget&&c()}},o.a.createElement("div",{className:"popup__container-pic-zoom"},o.a.createElement("button",{className:"link popup__close-button",onClick:c}),o.a.createElement("figure",{className:"picture-zoom"},o.a.createElement("img",{src:t.link,alt:t.name,className:"picture-zoom__img"}),o.a.createElement("p",{className:"picture-zoom__title"},t.name))))):""};var N=function(e){var t=e.isOpen,a=e.onClose,r=e.onUpdateUser,c=o.a.useContext(f),i=Object(n.useState)(""),s=Object(l.a)(i,2),u=s[0],p=s[1],m=Object(n.useState)(""),_=Object(l.a)(m,2),d=_[0],h=_[1];return Object(n.useEffect)((function(){p(c.name),h(c.about)}),[c]),o.a.createElement(k,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"edit-profile",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:function(){p(c.name),h(c.about),a()},onSubmit:function(e){e.preventDefault(),r({name:u,about:d})}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"text",value:u,onChange:function(e){p(e.target.value)},name:"profile-name",placeholder:"\u0418\u043c\u044f",id:"profile-name",className:"input popup__input popup__input_type_name",required:!0,minLength:"2",maxLength:"40"}),o.a.createElement("span",{className:"popup__input-error js-popup__input-error_type_profile"})),o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"text",value:d,onChange:function(e){h(e.target.value)},name:"profile-job",id:"profile-job",placeholder:"\u0420\u043e\u0434 \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438",className:"input popup__input popup__input_type_job",required:!0,minLength:"2",maxLength:"200"}),o.a.createElement("span",{className:"popup__input-error js-popup__input-error_type_profile"})))};var O=function(e){var t=e.isOpen,a=e.onClose,r=e.onUpdateAvatar,c=Object(n.useRef)({}),i=Object(n.useState)(""),s=Object(l.a)(i,2),u=(s[0],s[1]);return o.a.createElement(k,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"edit-avatar",buttonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:a,onSubmit:function(e){r({avatar:c.current.value})}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{ref:c,onChange:function(e){u(e.target.value)},type:"url",name:"avatar",id:"avatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"input popup__input popup__input_type_avatar",required:!0}),o.a.createElement("span",{className:"popup__input-error"})))};var S=function(e){var t=e.isOpen,a=e.onClose,r=e.onAddPlace,c=Object(n.useState)(""),i=Object(l.a)(c,2),s=i[0],u=i[1],p=Object(n.useState)(""),m=Object(l.a)(p,2),_=m[0],d=m[1];return o.a.createElement(k,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"add-place",buttonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:function(){u(""),d(""),a()},onSubmit:function(e){e.preventDefault(),r({name:s,link:_}),u(""),d("")}},o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"text",value:s,onChange:function(e){u(e.target.value)},name:"place-name",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",id:"place-name",className:"input popup__input popup__input_type_place-name",required:!0,minLength:"2",maxLength:"30"}),o.a.createElement("span",{className:"popup__input-error"})),o.a.createElement("label",{className:"popup__label"},o.a.createElement("input",{type:"url",value:_,onChange:function(e){d(e.target.value)},name:"place-pic",id:"place-pic",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"input popup__input popup__input_type_place-pic",required:!0}),o.a.createElement("span",{className:"popup__input-error"})))};var j=function(){var e=Object(n.useState)(!1),t=Object(l.a)(e,2),a=t[0],r=t[1],c=Object(n.useState)(!1),s=Object(l.a)(c,2),u=s[0],m=s[1],_=Object(n.useState)(!1),h=Object(l.a)(_,2),E=h[0],g=h[1],k=Object(n.useState)(!1),j=Object(l.a)(k,2),I=j[0],w=j[1],L=Object(n.useState)(!1),x=Object(l.a)(L,2),A=x[0],D=x[1],q=Object(n.useState)([]),U=Object(l.a)(q,2),T=U[0],B=U[1],P=Object(n.useState)({name:"\u0416\u0430\u043a \u0418\u0432 \u041a\u0443\u0441\u0442\u043e",about:"\u041c\u043e\u0440\u0435\u043f\u043b\u0430\u0432\u0430\u0442\u0435\u043b\u044c",avatar:"https://kaskad.tv/images/2020/foto_zhak_iv_kusto__-_interesnie_fakti_20190810_2078596433.jpg"}),R=Object(l.a)(P,2),z=R[0],M=R[1],V=Object(n.useState)(),W=Object(l.a)(V,2),J=W[0],F=W[1],H=Object(n.useState)(),$=Object(l.a)(H,2),G=$[0],K=$[1];function Q(){!function(){var e=document.querySelectorAll(".popup__input-error");e&&e.forEach((function(e){return e.classList.remove("popup__input-error_active")}))}(),g(!1),r(!1),m(!1),F(),w(!1),D(!1),K()}function X(e,t,a){t.textContent=e?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":a}return Object(n.useEffect)((function(){Promise.all([p.getItems("users/me"),p.getItems("cards")]).then((function(e){var t=Object(l.a)(e,2),a=t[0],n=t[1];M(a);var o=n.map((function(e){return{name:e.name,link:e.link,_id:e._id,likes:e.likes,owner:e.owner}}));B(o)})).catch((function(e){console.log("\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435 \u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u0435\u043a: ".concat(e))}))}),[]),o.a.createElement("div",{className:"App"},o.a.createElement(f.Provider,{value:z},o.a.createElement("div",{className:"page"},o.a.createElement("div",{className:"page__container"},o.a.createElement(d,null),o.a.createElement(v,{onEditProfile:function(){r(!0)},onAddPlace:function(){m(!0)},onEditAvatar:function(){g(!0)},handleCardClick:function(e){F(e),D(!0)},cards:T,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===z._id}));p.changeLikeCardStatus(e._id,!t).then((function(t){var a=T.map((function(a){return a._id===e._id?t:a}));B(a)})).catch((function(e){console.log("\u0418\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u044f \u0441\u0442\u0430\u0442\u0443\u0441\u0430 \u043b\u0430\u0439\u043a\u0430: ".concat(e))}))},onCardDelete:function(e,t){w(!0),F(e),K(t)}}),o.a.createElement(b,null),o.a.createElement(N,{isOpen:a,onClose:Q,onUpdateUser:function(e){var t=document.querySelector(".popup__save-button_type_edit-profile");X(!0,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),p.changeItem({name:e.name.trim(),about:e.about.trim()},"users/me").then((function(e){M(e)})).then((function(){Q()})).catch((function(e){console.log("\u041f\u0440\u0438 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0438 \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435: ".concat(e))})).finally((function(){X(!1,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))}}),o.a.createElement(S,{isOpen:u,onClose:Q,onAddPlace:function(e){var t=document.querySelector(".popup__save-button_type_add-place");X(!0,t,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c"),p.createItem(e,"cards").then((function(e){B([e].concat(Object(i.a)(T)))})).then((function(){Q()})).catch((function(e){console.log("\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){X(!1,t,"\u0421\u043e\u0437\u0434\u0430\u0442\u044c")}))}}),o.a.createElement(O,{isOpen:E,onClose:Q,onUpdateAvatar:function(e){var t=document.querySelector(".popup__save-button_type_edit-avatar");X(!0,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),p.changeItem({avatar:e.avatar},"users/me/avatar").then((function(e){M(e),document.querySelector(".profile__image").style.backgroundImage="url('".concat(e.avatar,"')")})).then((function(){Q()})).catch((function(e){console.log("\u041f\u0440\u0438 \u0438\u0437\u043c\u0435\u043d\u0435\u043d\u0438\u0438 \u0430\u0432\u0430\u0442\u0430\u0440\u0430 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f: ".concat(e))})).finally((function(){X(!1,t,"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}))}}),o.a.createElement(y,{title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",name:"card-delete",card:J,cardDOM:G,buttonText:"\u0414\u0430",isOpen:I,onClose:Q,onCardDeleteSubmit:function(e,t){var a=document.querySelector(".popup__save-button_type_card-delete");X(!0,a,"\u0414\u0430"),p.deleteItem("cards",e._id).then((function(){t.remove()})).then((function(){Q()})).catch((function(e){console.log("\u041f\u0440\u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0438 \u043a\u0430\u0440\u0442\u043e\u0447\u043a\u0438: ".concat(e))})).finally((function(){return X(!1,a,"\u0414\u0430")}))}}),o.a.createElement(C,{name:"picture-zoom",isOpen:A,card:J,onClose:Q})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(j,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},8:function(e,t,a){e.exports=a.p+"static/media/logo.a56cd5e0.svg"}},[[10,1,2]]]);
//# sourceMappingURL=main.a234d810.chunk.js.map